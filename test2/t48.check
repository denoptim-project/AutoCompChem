#!/bin/bash


grep -q -i "CHARGE[[:space:]]*-34" t48-mol.nw
if [ $? != 0 ] ; then
echo NOT Passed ERROR 2
exit -1
fi

grep -q -i "MULT[[:space:]]*3" t48-mol.nw
if [ $? != 0 ] ; then
echo NOT Passed ERROR 5
exit -1
fi

n=$(grep -c -i "^SET " t48-mol.nw)
if [ "$n" != 3 ] ; then
echo NOT Passed ERROR 7
exit -1
fi

n=$(grep -c -i "^UNSET " t48-mol.nw)
if [ "$n" != 3 ] ; then
echo NOT Passed ERROR 8
exit -1
fi

# Excluding test depedent on command bc
if [[ "$(uname)" == CYGWIN* ]] || [[ "$(uname)" == MINGW* ]] || [[ "$(uname)" == MSYS* ]]
then
    echo Skipping UNIX-only checks
else
    n=$(echo $(wc -l t48-mol.nw | awk '{print $1}') - $(grep -n SCF t48-mol.nw | awk -F":" '{print $1}') | bc)
    m=$(tail -n $n t48-mol.nw | grep -n -m1 END | awk -F":" '{print $1}')
    tail -n $n t48-mol.nw | head -n $m | grep -i -q "TRIPLET"
    if [ $? != 0 ] ; then
        echo NOT Passed ERROR 4
        exit -1
    fi
fi

grep -q 'Termination status: 0' t48.log
if [ $? == 0 ] ; then 
echo Passed
exit 0
else
echo NOT Passed ERROR 9
exit -1
fi
