#!/bin/bash

function not_passed() {
  echo "NOT Passed: check condition leading to line '$1' of '$0'"
  exit -1
}

if [ ! -f t29.log ] ; then not_passed $LINENO ; fi

grep -q 'Mol.0 BESCAF Dst.dist Fe1:C19 = 3.432' t29.log
if [ $? != 0 ] ; then not_passed $LINENO ; fi
grep -q 'Mol.1 CEPKOZ Dst.dist Fe1:C69 = 3.540' t29.log
if [ $? != 0 ] ; then not_passed $LINENO ; fi 
grep -q 'Mol.1 CEPKOZ Dst.dist Fe2:C69 = 1.726' t29.log
if [ $? != 0 ] ; then not_passed $LINENO ; fi
grep -q 'Mol.2 FEXKUQ Dst.dist Fe3:C21 = 3.251' t29.log
if [ $? != 0 ] ; then not_passed $LINENO ; fi 
grep -q 'Mol.2 FEXKUQ Dst.dist Fe3:C17 = 1.789' t29.log
if [ $? != 0 ] ; then not_passed $LINENO ; fi


if [ ! -f t29.dat ] ; then not_passed $LINENO ; fi
n=0; n=$(grep -c "dist" t29.dat)
if [ 3 != "$n" ]; then not_passed $LINENO ; fi

if grep -q 'Termination status: 0' t29.log ; then
  echo Passed
  exit 0
else
  echo NOT Passed 99
  exit -1
fi
