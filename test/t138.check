#!/bin/bash

if [ ! -f t138_jd_XTB.json ] ; then
echo NOT Passed ERROR 1
exit -1
fi

if [ ! -f t138_jd_manyJobs.json ] ; then
echo NOT Passed ERROR 2
exit -1
fi

n=0;n=$(grep -c "^.* \"ACCJob\",$" t138_jd_manyJobs.json)
if [ $n -ne 7 ] ; then echo NOT Passes ERROR 3 ; exit -1 ; fi
n=0;n=$(grep -c "^.* \"MeasureGeomDescriptors\",$" t138_jd_manyJobs.json)
if [ $n -ne 4 ] ; then echo NOT Passes ERROR 4 ; exit -1 ; fi
n=0;n=$(grep -c "^.* \"PruneMolecules\",$" t138_jd_manyJobs.json)
if [ $n -ne 2 ] ; then echo NOT Passes ERROR 5 ; exit -1 ; fi
n=0;n=$(grep -c "^ *\"SMARTS\": " t138_jd_manyJobs.json)
if [ $n -ne 6 ] ; then echo NOT Passes ERROR 6 ; exit -1 ; fi

n=0;n=$(grep -c "^ *\"accTaskParams\": " t138_jd_XTB.json)
if [ $n -ne 2 ] ; then echo NOT Passes ERROR 7 ; exit -1 ; fi
n=0;n=$(grep -c "^ *\"ATOMIDS\": " t138_jd_XTB.json)
if [ $n -ne 2 ] ; then echo NOT Passes ERROR 8 ; exit -1 ; fi
n=0;n=$(grep -c "^ *\"isLoud\": " t138_jd_XTB.json)
if [ $n -ne 6 ] ; then echo NOT Passes ERROR 9 ; exit -1 ; fi

grep -q 'Termination status: 0' t138.log
if [ $? == 0 ] ; then 
echo Passed
exit 0
else
echo NOT Passed ERROR 99
exit -1
fi
